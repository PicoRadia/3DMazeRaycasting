
initEnemies=function(){addEnemies();for(var e=$("screen"),t=0;t<mapEnemies.length;t++){var s=mapEnemies[t],a=enemyTypes[s.type],i=document.createElement("img");i.src=a.img,i.style.display="none",i.style.position="absolute",s.state=0,s.rot=0,s.dir=0,s.speed=0,s.moveSpeed=a.moveSpeed,s.rotSpeed=a.rotSpeed,s.numOfStates=a.numOfStates,s.prevStyle={left:0,top:0,width:0,height:0,clip:"",display:"none",zIndex:0},s.img=i,enemies.push(s),e.appendChild(i)}};var enemies=[],mapEnemies=[],enemyTypes=[{img:"src/assets/rat.png",moveSpeed:.05,rotSpeed:3,numOfStates:9}];addEnemies=function(){mapEnemies.push({type:0,x:8.5,y:27.5})},renderEnemies=function(){for(var e=0;e<enemies.length;e++){var t=enemies[e],s=t.x-player.x,a=t.y-player.y,i=Math.sqrt(s*s+a*a);if(i<10){var n=Math.atan2(a,s)-player.rotation;if(n<-Math.PI&&(n+=2*Math.PI),n>=Math.PI&&(n-=2*Math.PI),n>-Math.PI&&n<Math.PI){var r=t.img,p=viewDist/(Math.cos(n)*i),l=Math.tan(n)*viewDist,h=t.prevStyle;p!=h.height&&(r.style.height=p+"px",h.height=p),p*t.numOfStates!=h.width&&(r.style.width=p*t.numOfStates+"px",h.width=p*t.numOfStates),(screenHeight-p)/2!=h.top&&(r.style.top=(screenHeight-p)/2+"px",h.top=(screenHeight-p)/2),screenWidth/2+l-p/2-p*t.state!=h.left&&(r.style.left=screenWidth/2+l-p/2-p*t.state+"px",h.left=screenWidth/2+l-p/2-p*t.state),"brightness("+(100-15*i)+"%)"!=h.filter&&(r.style.filter="brightness("+(100-15*i)+"%)",h.filter="brightness("+(100-15*i)+"%)"),p>>0!=h.zIndex&&(r.style.zIndex=p>>0,h.zIndex=p>>0),"block"!=h.display&&(r.style.display="block",h.display="block"),"rect(0, "+p*(t.state+1)+", "+p+", "+p*t.state+")"!=h.clip&&(r.style.clip="rect(0, "+p*(t.state+1)+", "+p+", "+p*t.state+")",h.clip="rect(0, "+p*(t.state+1)+", "+p+", "+p*t.state+")")}enemyAI(t)}}},enemyAI=function(e){var t=player.x-e.x,s=player.y-e.y,a=Math.sqrt(t*t+s*s);if(a>2&&a<8){var i=Math.atan2(s,t);e.rotDeg=180*i/Math.PI,e.rot=i,e.speed=1;e.state=Math.floor(new Date%1e3/(1e3/7))+1}else e.state=0,e.speed=0;enemyMove(e)},enemyMove=function(e){var t=e.speed*e.moveSpeed,s=e.x+Math.cos(e.rot)*t,a=e.y+Math.sin(e.rot)*t,i=checkCollision(e.x,e.y,s,a,.35);e.x=i.x,e.y=i.y};